{"version":3,"sources":["fields/taxonomy-select/scripts.js"],"names":["window","document","$","AO","$document","ptsData","AlchemyTaxonomySelectData","currentUrl","URL","fieldData","searchParams","select2","pageID","locale","location","href","get","type","dataType","delay","url","params","data","searchedFor","term","_wpnonce","nonce","taxonomy","page-id","processResults","results","$target","minimumInputLength","append","change","e","target","siblings","children","concat","on","id","option","detach","$select","Promise","resolve","val","ready","$ptsSelects","initialise_taxonomy_select","each","i","select","repeatee","get_taxonomy_select_value","jQuery","value"],"mappings":"AAAA,cAEA,SAACA,EAAAC,EAAAC,GACGF,EAAAG,GAAYH,EAAAG,IAAZ,GAIAC,IAAAA,EAAgBF,EAAAD,GAwBZ,SAAMI,EAAUC,GACVC,IAAAA,EAAaL,EAAIM,GACXC,EAAGF,EAAWG,KAAAA,WAElBC,EAAQL,0BAAA,OAENM,EADcC,IAAAA,IADRb,EAAAc,SAAAC,MAENL,aAAAM,IAAA,QAEFC,EAAMN,QAFJ,CAGFO,SAAUT,EAHRI,OAIFM,KAJE,CAKIC,IAAAf,EAAAgB,IACFJ,KAAO,MACHC,SAAA,OACAC,MAAA,IACAG,KAAA,SAAAD,GACA,MAAWT,CAJfW,YAAAF,EAAAG,KANFC,SAAApB,EAAAqB,MAacC,SAAAlB,EAAA,SACLmB,UAAAhB,IAdTiB,eAAA,SAAAP,GAkBK,MAAA,CApBCQ,QAAAR,EAAAA,OAwBNS,OAAa,GAGbC,mBAAN,IACAD,GAAQE,iBAAeC,SAAAA,GA5B3B,IAAAH,EAAA7B,EAAAiC,EAAAC,QA+BQC,EAASN,EAAAO,SAAA,UAAAC,OAAiCC,EAAlDnB,OAAqDC,KAASmB,GAA7C,MAAjBC,EAAAC,SAGHZ,EAAAE,OAAAS,GAAAR,WAGGU,EAAOC,SAAQC,iCAASN,GAAA,QAAA,WACpBI,EAAQG,IAAA,IAAAb,WAlEhB9B,EAAU4C,MAAM,WAGRC,IAAAA,EAAiB/C,EAAA,4BAEbgD,EAAAA,IADJD,EAAAE,KAAA,SAAAC,EAAAC,GAGHH,EAAAG,OAGLjD,EAAUoC,GAAG,sBAAuB,SAASL,EAAGb,GAIxC2B,IACAA,EADiB3B,EAAAgC,SACID,KAAJ,4BAAjBJ,EAAA,IAGHA,EAAAE,KAAA,SAAAC,EAAAC,GARLH,EAAAG,OAsDAlD,GAAAoD,0BAAA,SAAAd,GAODzC,OAAQC,QAAUuD,QA5ErB,CAuEYvC,KAAQ,kBACRwB,GAAMA,EACNgB,MAASvD,EAAC,IAAAqC,OAAKE,IAAMM,SAzEjC,CA4EG/C,OAAQC,SAAUuD","file":"fields\\taxonomy-select\\scripts.min.js","sourcesContent":["\"use strict\";\r\n\r\n(function(window, document, $) {\r\n    window.AO = window.AO || {};\r\n\r\n    const $document = $(document);\r\n\r\n    $document.ready(() => {\r\n        const $ptsSelects = $('.jsAlchemyTaxonomySelect');\r\n\r\n        if( $ptsSelects[0] ) {\r\n            $ptsSelects.each((i, select) => {\r\n                initialise_taxonomy_select(select);\r\n            });\r\n        }\r\n    });\r\n\r\n    $document.on('alch_repeatee_added', function(e, data) {\r\n        const $repeatee = data.repeatee;\r\n        const $ptsSelects = $repeatee.find('.jsAlchemyTaxonomySelect');\r\n\r\n        if( $ptsSelects[0] ) {\r\n            $ptsSelects.each((i, select) => {\r\n                initialise_taxonomy_select(select);\r\n            });\r\n        }\r\n    });\r\n\r\n    function initialise_taxonomy_select(taxonomySelect) {\r\n        const $select = $(taxonomySelect);\r\n        const fieldData = $select.data('alchemy');\r\n        const ptsData = AlchemyTaxonomySelectData['search'];\r\n        const currentUrl = new URL(window.location.href);\r\n        const pageID = currentUrl.searchParams.get('page');\r\n\r\n        $select.select2({\r\n            language: fieldData.locale,\r\n            ajax: {\r\n                url: ptsData.url,\r\n                type: 'get',\r\n                dataType: 'json',\r\n                delay: 250,\r\n                data: params => {\r\n                    return {\r\n                        'searchedFor': params.term,\r\n                        '_wpnonce': ptsData.nonce,\r\n                        'taxonomy': fieldData['taxonomy'],\r\n                        'page-id': pageID\r\n                    };\r\n                },\r\n                processResults: data => {\r\n                    return {\r\n                        results: data.data,\r\n                    };\r\n                },\r\n                cache: false\r\n            },\r\n            minimumInputLength: 2\r\n        }).on('select2:select', e => {\r\n            const $target = $(e.target);\r\n            const option = $target.children(`[value=${e.params.data.id}]`);\r\n\r\n            option.detach();\r\n            $target.append(option).change();\r\n        });\r\n\r\n        $select.siblings('.jsAlchemyTaxonomySelectClear').on('click', () => {\r\n            $select.val(\"\").change();\r\n        });\r\n    }\r\n\r\n    AO.get_taxonomy_select_value = id => {\r\n        return Promise.resolve( {\r\n            'type': 'taxonomy_select',\r\n            'id': id,\r\n            'value': $(`#${id}`).val()\r\n        } );\r\n    };\r\n})(window, document, jQuery);"]}