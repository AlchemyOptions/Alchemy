"use strict";!function(p,e,h){p.AO=p.AO||{},h(e).on("tinymce-editor-init",function(){AO.tinymce=AO.tinymce||{},AO.tinymce.initialSettings=tinyMCEPreInit.mceInit["alchemy-temp-editor"]}),h(function(){var e=h(".jsAlchemy"),o=h(".jsAlchemyMetaBox");if(e){var a=h(".jsAlchemyOptions"),n=new URL(p.location.href).searchParams.get("page"),s=new FormData,c={},t=a.children(".jsAlchemyField"),i=[];if(t.each(function(e,a){var t=h(a);if("sections"===t.data("alchemy").type){var n=t.find(".jsAlchemySectionsTab").children(".jsAlchemyField");n[0]&&n.each(function(e,a){i.push(h(a))})}else i.push(t)}),e.on("click",".jsAlchemySaveOptions",function(){var a=h(this),e=h(i).map(function(e,a){var t=a.data("alchemy");return a.removeClass("alchemy__field--invalid").children(".jsAlchemyValidationTooltip").find(".jsAlchemyTooltipText").text(""),new Function("return AO['get_".concat(t.type,"_value']('").concat(t.id,"');"))(t.id)}).get();h.each(c,function(e,a){a.destroy()}),a.attr("disabled",!0).next(".jsAlchemyLoader").removeClass("alchemy__spinner--hidden");var t=AlchemyData["save-options"];a.data()&&"network"===a.data("type")&&(t=AlchemyData["save-network-options"]),Promise.all(e).then(function(e){s.append("_wpnonce",t.nonce),s.append("page-id",n),s.append("values",JSON.stringify(e)),h.ajax({method:"POST",url:t.url,dataType:"json",processData:!1,contentType:!1,data:s,success:function(){p.location.reload()},error:function(e){if(e.responseJSON.data&&"alch-save-validation-errors"===e.responseJSON.code){var o=e.responseJSON.data["invalid-fields"],s=0;h(i).each(function(e,a){var t=a.data("alchemy");if(o[t.id]){var n=a.children(".jsAlchemyValidationTooltip"),i=a.offset().top;s=-100+(s<i?i:s),n[0]&&(n.attr("data-show",!0).find(".jsAlchemyTooltipText").text(o[t.id]),a.addClass("alchemy__field--invalid").parents(".repeatee").addClass("repeatee--expanded"),c[t.id]=Popper.createPopper(a[0],n[0],{placement:"top",modifiers:[{name:"flip",options:{fallbackPlacements:["top-start"]}}]}),a.one("hover focus",function(){a.hasClass("alchemy__field--invalid")&&(a.removeClass("alchemy__field--invalid"),c[t.id]&&(c[t.id].destroy(),n.removeAttr("data-show")))}),s&&h("html").add("body").animate({scrollTop:s},500))}})}a.next(".jsAlchemyLoader").addClass("alchemy__spinner--hidden")},complete:function(){a.removeAttr("disabled")}})})}),o[0]){var l=h("#post"),d=o.closest(".postbox");d.find(".hndle").removeClass("hndle"),d.find(".handle-order-higher").remove(),d.find(".handle-order-lower").remove(),l[0]?h("#publish").on("click",function(e){h(this).attr("disabled",!0),r(l),e.preventDefault()}):wp.data&&wp.data.subscribe&&wp.data.subscribe(function(){var e=wp.data.select("core/editor");e.isSavingPost()&&!e.isAutosavingPost()&&r()})}}function r(a){var e=o.children(".metabox__fields").children(".jsAlchemyField"),i=[];e.each(function(e,a){var t=h(a);if("sections"===t.data("alchemy").type){var n=t.find(".jsAlchemySectionsTab").children(".jsAlchemyField");n[0]&&n.each(function(e,a){i.push(h(a))})}else i.push(t)});var t=h(i).map(function(e,a){var t=h(a).data("alchemy");return new Function("return AO['get_".concat(t.type,"_value']('").concat(t.id,"');"))(t.id)}).get(),n=AlchemyData["save-metaboxes"];Promise.all(t).then(function(e){s.append("_wpnonce",n.nonce),s.append("post-id",n.postID),s.append("values",JSON.stringify(e)),h.ajax({method:"POST",url:n.url,dataType:"json",processData:!1,contentType:!1,data:s,success:function(){a&&a[0]&&a.submit()}})})}})}(window,document,jQuery);
//# sourceMappingURL=alchemy.min.js.map